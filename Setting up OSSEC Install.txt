Setting up OSSEC

- Install the following packages
	`sudo apt-get install build-essential make zlib1g-dev libpcre2-dev libevent-dev libssl-dev libsqlite3-dev libsystemd-dev`

- Go to OSSEC repo releases page and go to the latest release and pick the source code with extension tar.gz and download
	`https://github.com/ossec/ossec-hids/releases`

As at the time of working on this project the latest version of OSSEC is 3.8.0 so replace <version> with that version number in the steps that follow

- Move the file from the Downloads directory to your root directory
	`mv ~/Downloads/ossec-hids-<version>.tar.gz .`

- Extract the file
	`tar xzvf ossec-hids-<version>.tar.gz`

- Go into the directory
	`cd ossec-hids-<version>`

- Make the install.sh file an executable
	`chmod +x install.sh`

- Execute the file with root privileges
	`sudo ./install.sh`
	
- You will be provided with the prompts below after running the install script

1- What kind of installation do you want (server, agent, local, hybrid or help)? server

  - Server installation chosen.

2- Setting up the installation environment.

 - Choose where to install the OSSEC HIDS [/var/ossec]: 

    - Installation will be made at  /var/ossec .

3- Configuring the OSSEC HIDS.

  3.1- Do you want e-mail notification? (y/n) [y]: y or n works for this step. it is your choice
   - What's your e-mail address? email@gmail.com

   - We found your SMTP server as: alt4.gmail-smtp-in.l.google.com.
   - Do you want to use it? (y/n) [y]: n

   - What's your SMTP server ip/host? smtp.gmail.com
 
  3.2- Do you want to run the integrity check daemon? (y/n) [y]: y

   - Running syscheck (integrity check daemon).

  3.3- Do you want to run the rootkit detection engine? (y/n) [y]: y

   - Running rootcheck (rootkit detection).

  3.4- Active response allows you to execute a specific 
       command based on the events received. For example,
       you can block an IP address or disable access for
       a specific user.  
       More information at:
       http://www.ossec.net/docs/docs/manual/ar/index.html
       
   - Do you want to enable active response? (y/n) [y]: y

     - Active response enabled.
   
   - By default, we can enable the host-deny and the 
     firewall-drop responses. The first one will add
     a host to the /etc/hosts.deny and the second one
     will block the host on iptables (if linux) or on
     ipfilter (if Solaris, FreeBSD or NetBSD).
   - They can be used to stop SSHD brute force scans, 
     portscans and some other forms of attacks. You can 
     also add them to block on snort events, for example.

   - Do you want to enable the firewall-drop response? (y/n) [y]: y

     - firewall-drop enabled (local) for levels >= 6

   - 
      - 127.0.0.53

   - Do you want to add more IPs to the white list? (y/n)? [n]: n

  3.5- Do you want to enable remote syslog (port 514 udp)? (y/n) [y]: y

   - Remote syslog enabled.

  3.6- Setting the configuration to analyze the following logs:
    -- /var/log/auth.log
    -- /var/log/syslog
    -- /var/log/dpkg.log
    -- /var/log/apache2/error.log (apache log)
    -- /var/log/apache2/access.log (apache log)

 - If you want to monitor any other file, just change 
   the ossec.conf and add a new localfile entry.
   Any questions about the configuration can be answered
   by visiting us online at http://www.ossec.net .
   
   
   --- Press ENTER to continue ---


- Run this command
    `sudo visudo`

- Paste this at the bottom of the file and save:
    `<yourusername> ALL=(ALL) NOPASSWD: /var/ossec/bin/ossec-control`
  Replace <yourusername> with your computer username. THis is to prevent passwordless login for sudo commands used in the app for ossec services
------------------------------------------------------
	
ADDED NECESSARY INFORMATION
- Switch to root user
      `sudo -i`

- To start OSSEC HIDS:
      /var/ossec/bin/ossec-control start

- To stop OSSEC HIDS:
      /var/ossec/bin/ossec-control stop

- The configuration can be viewed or modified at /var/ossec/etc/ossec.conf
 
- In order to connect agent and server, you need to add each agent to the server.
   Run the 'manage_agents' to add or remove them:

   /var/ossec/bin/manage_agents

   More information at: 
   http://www.ossec.net/docs/docs/programs/manage_agents.html


Copying from one server to another
